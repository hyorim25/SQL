# SQL  
  
## SQL 활용 1  
  
### 1. 표준 조인  
  
1. 일반 집합 연산자  
  
(1) UNION 합집합 공통 교집합의 중복을 제거  
(1-2) UNION ALL 공통집합을 중복해서 그대로 보여주기 때문에 정렬 작업이 일어나지 않음  
(2) INTERSECTION 교집합 두 집합의 공통 집합 추출  
(3) DIFFERENCE 차집합 첫번째 집합에서 두번째 집합과의 공통 집합을 제외  
(4) PRODUCT 곱집합 JOIN 조건이 없는 경우 생길 수 있는 모든 데이터의 조합  
  
2. 순수 관계 연산자  
  
(1) SELECT -> WHERE 절의 조건절 기능으로 구현  
(2) PROJECT -> SELECT 절의 칼럼 선택 기능으로 구현  
(3) NATURAL -> 다양한 JOIN  
(4) DIVIDE -> 현재 사용 X  
  
3. FROM 절 JOIN 형태  
  
(1) INNER JOIN  
(2) NATURAL JOIN  
(3) USING 조건절  
(4) ON 조건절  
(5) CROSS JOIN  
(6) OUTER JOIN  
  
INNER JOIN : JOIN 조건에서 동일한 값이 있는 행만 반환, USING 조건절이나 ON 조건절 필수로 사용  
  
NATURAL JOIN : 두 테이블 간의 동일한 이름을 갖는 모든 칼럼들에 대해 EQUI JOIN 수행, USING 조건절, ON 조건절, WHERE 절에서 JOIN 조건을 정의할 수 X  
  
USING 조건절 : FROM 절의 USING 조건절을 이용하면 같은 이름을 가진 칼럼들 중에서 원하는 칼럼에 대해서만 선택적으로 EQUI JOIN 가능  
  
ON 조건절 : JOIN 서술부와 비 JOIN 서술부를 분리하여 이해가 쉬우며, 칼럼명이 다르더라도 JOIN 조건을 사용할 수 있는 장점 있음  
  
CROSS JOIN : 양쪽 집합의 M*N건의 데이터 조합이 발생  
  
OUTER JOIN : JOIN 조건에서 동일한 값이 없는 행도 반환할 때 사용 가능  
  
LEFT OUTER JOIN : 조인 수행시 먼저 표기된 좌측 테이블에 해당하는 데이터를 읽은 후, 나중 표기된 우측 테이블에서 JOIN 대상 데이터를 읽어옴 우측 값에서 같은 값이 없는 경우 NULL 값으로 채움  
  
RIGHT OUTER JOIN : LEFT OUTER JOIN의 반대  
  
FULL OUTER JOIN : 조인 수행시 좌측, 우측 테이블의 모든 데이터를 읽어 JOIN하여 결과를 생성 중복 데이터는 삭제  
  
### 2. 집합 연산자  
  
집합 연산자 : 두 개 이사의 테이블에서 조인을 사용하지 않고 연관된 데이터를 조회하는 방법, 여러 개의 질의의 결과를 연결하여 하나로 결합하는 방식 사용  
-> 2개 이상의 질의 결과를 하나의 결과로 만들어줌  
  
![logo](http://www.dbguide.net/publishing/img/knowledge/SQL_204.jpg)  
  
### 3. 계층형 질의  
  
1. 계층형 질의  
  
계층형 질의 ? 동일 테이블에 계층적으로 상위와 하위 데이터가 포함된 데이터  
  
START WITH 절 : 계층 구조 전개의 시작을 지정하는 구문, 루트 데이터를 지정  
  
CONNECT BY 절 : 다음에 전개될 자식 데이터를 지정하는 구문  
  
PRIOR : CONNECT BY절에 사용되며 현재 읽은 칼럼 지정  
  
NO CYCLE : 데이터를 전개하면서 이미 나타났던 동일한 데이터가 전개 중에 다시 나타남, 사이클이 발생한 데이터는 런타임 오류 발생, NO CYCLE 추가하면 사이클이 발생한 이후의 데이터는 전개 X  
  
ORDER SIBLINGS BY : 형제 노드 사이에서 정렬을 수행한다  
  
WHERE : 모든 전개를 수행한 후에 지정된 조건을 만족하는 데이터만  추출  
  
계층형 질의에서 사용되는 가상 칼럼  
LEVEL : 루트 데이터면 1, 그 하위 데이터면 2이다. 리프 데이터까지 1씩 증가함  
  
CONNECT_BY_ISLEAF : 전개 과정에서 해당 데이터가 리프 데이터이면 1, 그렇지 않으면 0  
  
CONNECT_BY_ISCYCLE : 전개 과정에서 자식을 갖는데, 해당 데이터가 조상으로부터 존재하면 1, 그렇지 않으면 0 CYCLE 옵션을 사용했을 때에만 사용 가능  
  
2. 셀프 조인  
  
셀프 조인 ? 동일 테이블 사이의 조인  
FROM 절에 동일 테이블이 두번 이상 나타남  
동일 테이블 사이의 조인을 수행, 테이블과 칼러 이름이 모두 동일하기 때문에 식별을 위해 반드시 테이블 별칭을 사용  
  
사용법  
```  
SELECT ALIAS명 1. 칼럼명, ALIAS명 2. 칼럼명, ... FROM 테이블1 ALIAS명 1, 테이블2 ALIAS명2 WHERE ALIAS명 1.칼럼명2 = ALIAS명 2. 칼럼명 2;  
```  
  
### 3. 서브쿼리  
  
서브쿼리 ? SQL문안에 포함되어 있는 또 다른 SQL문  
알려지지 않은 기준을 이용한 검색을 위해 사용  
  
서브쿼리 사용시 주의사항  
(1) 서브쿼리를 괄호로 감싸서 사용  
(2) 단일행 또는 복수행 비교 연산자와 함께 사용 가능, 단일행 비교 연산자는 서브쿼리 결과가 반드시 1건 이하, 복수행 비교 연산자는 서브쿼리의 결과 건수와 사용 X  
(3) 서브쿼리에서는 ORDER BY 를 사용 X  
  
서브쿼리가 SQL문에서 사용이 가능한 곳  
SELECT 절  
FROM 절  
WHERE 절  
HAVING 절  
ORDER BY 절  
INSERT 문의 VALUES 절  
UPDATE 문의 SET 절  
  
![logo](http://www.dbguide.net/publishing/img/knowledge/SQL_216.jpg)  
  
연관 서브 쿼리  
:서브쿼리 내에 메인쿼리 칼럼이 사용된 서브쿼리  
  
스칼라 서브쿼리  
:한 행, 한 칼럼만을 반환하는 서브쿼리  
  
인라인 뷰  
:테이블 명이 올 수 있는 곳에 사용, ORDER BY 사용 가능  
  
뷰  
:테이블은 실제로 데이터를 가지고 있는 반면, 뷰는 실제 데이터를 가지고 있지 않다. 가상 테이블이라고도 함  
  
뷰 사용시 장점  
(1) 독립성 : 테이블 구조가 변경되어도 뷰를 사용하는 응용 프로그램을 변경하지 않아도 된다  
(2) 편리성 : 복잡한 질의를 뷰로 생성함으로써 관련 질의를 단순하게 작성 가능 해당 형태의 SQL문을 자주 사용할 때 뷰를 이용하면 편리하게 사용 가능  
(3) 보안성 : 직원의 급여정보와 같이 숨기고 싶은 정보가 존재한다면, 뷰를 생성할 때 해당 칼럼을 빼고 생성함으로써 사용자에게 정보 감추기 가능

  



