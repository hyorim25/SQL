# SQL  
  
## 데이터 모델과 성능  
  
### 1. 성능 데이터 모델링의 개요  
1. 성능 데이터 모델링의 정의  
데이터 모델링을 할 때, 어떤 작업 유형에 따라 성능 향상을 도모해야 하는지 목표를 분명하게 해야 정확한 성능 향상 모델링 할 수 있음  
-> 성능 데이터 모델링이란 ?  
DB 성능 향상을 목적으로 설계 단계의 데이터 모델링때부터 정규화, 반정규화, 테이블통합, 테이블분할, 조인구조, PK, FK 등 여러 가지 성능과 관련된 사항이 데이터 모델링에 반영될 수 있도록 하는 것  
  
2. 성능 데이터 모델링 수행 시점  
![logo](http://www.dbguide.net/publishing/img/knowledge/SQL_073.jpg)  
**분석/설계 단계가 중요한 이유**
- 데이터 모델의 성능을 고려한 데이터 모델링을 할 경우, 성능 저하에 따른 재업무 비용 최소화 가능  
  
3. 성능 데이터 고려사항  
(1) 데이터 모델링을 할 때 정규화를 정확하게 수행한다  
(2) 데이터베이스 용량산정을 수행한다  
(3) 데이터베이스에 발생되는 트랜잭션의 유형을 파악한다  
(4) 용량과 트랜잭션의 유형에 따라 반정규화를 수행한다  
(5) 이력모델의 조정, PK/FK조정, 슈퍼타입/서브타입 조정 등을 수행한다  
(6) 성능관점에서 데이터 모델을 검증한다
  
### 2. 정규화와 성능  
  
데이터는 속상간의 함수 종속성에 근거하여 정규화 되어야 한다  
**함수의 종속성** : 데이터들이 어떤 기준 값에 의해 종속되는 현상  
기준값 : 결정자 종속되는 값 : 종속자  
함수의 종속성은 데이터가 가지고 있는 근본적인 속성  
**정규화** : 반복적인 데이터를 분리하고 각 데이터가 종속된 테이블에 적절하게 배치되도록 하는 것  
  
### 3. 반정규화와 성능  
  
**반정규화** : 정규화된 엔터티, 속성, 관계에 대해 시스템의 성능향상과 개발과 운영의 단순화를 위해 중복, 통합, 분리 등을 수행하는 데이터 모델링의 기법  
반정규화 적용 이유 : (1) 데이터를 조회할 때 디스크 I/O량이 많아서 성능이 저하되거나 경로가 너무 멀어 조인으로 인한 성능 저하 (2) 칼럼을 계산하여 읽을 때 성능 저하  
일반적으로 정규화시 입력/수정/삭제 성능이 향상  
반정규화시 조인 성능이 향상  
  
**반정규화 절차**  
  
(1) 반정규화 대상 조사  
1. 자주 사용되는 테이블에 접근 하는 프로세스의 수가 많고 항상 일정한 범위만을 조회하는 경우에 반정규화를 검토  
2. 테이블에 대량의 데이터가 있고 대량의 데이터 범위를 자주 처리하는 경우에 처리범위를 일정하게 줄이지 않으면 성능을 보장할 수 없을 경우에 반정규화를 검토한다.  
3. 통계성 프로세스에 의해 통계 정보를 필요로 할 때 별도의 통계테이블(반정규화 테이블)을 생성한다.  
4. 테이블에 지나치게 많은 조인(JOIN)이 걸려 데이터를 조회하는 작업이 기술적으로 어려울 경우 반정규화를 검토한다.  
  
(2) 다른 방법 유도 검토  
1. 지나치게 많은 조인이 걸려 데이터를 조회하는 작업이 기술적으로 어려울 경우 VIEW 사용  
2. 대량의 데이터처리나 부분처리에 의해 성능이 저하되는 경우 클러스터링을 적용하거나 인덱스를 조정  
3. 대량의 데이터는 PK의 성격에 따라 부분적인 테이블로 분리 가능  
4. 응용 애플리케이션에서 로직을 구사하는 방법을 변경함으로써 성능을 향상 가능  
  
 (3) 반정규화 적용

**반정규화의 기법**  
  
(1) 테이블 반정규화  
![logo](http://www.dbguide.net/publishing/img/knowledge/SQL_091.jpg)  
  
(2) 칼럼 반정규화  
![logo](http://www.dbguide.net/publishing/img/knowledge/SQL_092.jpg)  
  
(3) 관계 반정규화  
![logo](http://www.dbguide.net/publishing/img/knowledge/SQL_093.jpg)  
  

